import{r as e,j as s}from"./ui-vendor-BTYnCCVH.js";import{c as r,y as a,J as t,B as l,R as n,E as c,F as i,x as d,C as x,ag as o,w as m}from"./index-zo8qnSR5.js";import{S as h,a as j,b as p,c as u,d as g}from"./select-hTLcSUCI.js";import"./query-vendor-GfKyIrYs.js";import"./react-vendor-CazXVoUc.js";import"./chevron-down-RCTK2D2Z.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=r("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),y=()=>{const[r,y]=e.useState([]),[N,f]=e.useState({total:0,unresolved:0,critical:0,frontend:0,backend:0}),[b,w]=e.useState({total:0,page:1,limit:50,pages:0}),[k,S]=e.useState(!0),[C,E]=e.useState("all"),[F,R]=e.useState("all"),[T,V]=e.useState("unresolved"),[A,_]=e.useState(null),z=async()=>{try{S(!0);const e={};"all"!==C&&(e.severity=C),"all"!==F&&(e.error_type=F),"all"!==T&&(e.resolved="resolved"===T);const s=await o.getErrors(b.page,b.limit,e);y(s.data||[]),w(s.pagination||b)}catch(e){m.error("Failed to fetch errors")}finally{S(!1)}},L=async()=>{try{const e=await o.getErrorStats();f(e)}catch(e){}};e.useEffect(()=>{z(),L()},[b.page,C,F,T]);const M=e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-300";case"error":return"bg-orange-100 text-orange-800 border-orange-300";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Error Tracking"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and resolve application errors"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Total Errors"}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:N.total})]})}),s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Unresolved"}),s.jsx("p",{className:"text-3xl font-bold text-orange-600 mt-2",children:N.unresolved})]})}),s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Critical"}),s.jsx("p",{className:"text-3xl font-bold text-red-600 mt-2",children:N.critical})]})}),s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Frontend"}),s.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:N.frontend})]})}),s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Backend"}),s.jsx("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:N.backend})]})})]}),s.jsx(a,{children:s.jsx(t,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[s.jsxs("div",{className:"flex-1 min-w-[200px]",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Severity"}),s.jsxs(h,{value:C,onValueChange:E,children:[s.jsx(j,{children:s.jsx(p,{})}),s.jsxs(u,{children:[s.jsx(g,{value:"all",children:"All Severities"}),s.jsx(g,{value:"critical",children:"Critical"}),s.jsx(g,{value:"error",children:"Error"}),s.jsx(g,{value:"warning",children:"Warning"})]})]})]}),s.jsxs("div",{className:"flex-1 min-w-[200px]",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Type"}),s.jsxs(h,{value:F,onValueChange:R,children:[s.jsx(j,{children:s.jsx(p,{})}),s.jsxs(u,{children:[s.jsx(g,{value:"all",children:"All Types"}),s.jsx(g,{value:"frontend",children:"Frontend"}),s.jsx(g,{value:"backend",children:"Backend"})]})]})]}),s.jsxs("div",{className:"flex-1 min-w-[200px]",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Status"}),s.jsxs(h,{value:T,onValueChange:V,children:[s.jsx(j,{children:s.jsx(p,{})}),s.jsxs(u,{children:[s.jsx(g,{value:"all",children:"All Status"}),s.jsx(g,{value:"unresolved",children:"Unresolved"}),s.jsx(g,{value:"resolved",children:"Resolved"})]})]})]}),s.jsx("div",{className:"pt-6",children:s.jsxs(l,{onClick:()=>{z(),L()},variant:"outline",children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]})})}),s.jsxs(a,{children:[s.jsx(c,{children:s.jsx(i,{children:"Error Logs"})}),s.jsxs(t,{children:[k?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading errors..."}):0===r.length?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(d,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),s.jsx("p",{children:"No errors found"})]}):s.jsx("div",{className:"space-y-4",children:r.map(e=>{return s.jsxs("div",{className:`border rounded-lg p-4 ${M(e.severity)}`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-white border",children:e.error_type}),s.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-white border",children:e.severity}),e.resolved&&s.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 border border-green-300",children:"Resolved"})]}),s.jsx("p",{className:"font-medium text-gray-900 mb-1",children:e.message}),s.jsxs("p",{className:"text-sm text-gray-600",children:[e.component&&`Component: ${e.component} • `,"Admin: ",e.admin_email," • ",(r=e.timestamp,new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))]}),e.url&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["URL: ",e.url]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[!e.resolved&&s.jsxs(l,{size:"sm",variant:"outline",onClick:()=>(async s=>{try{await o.resolveError(s),m.success("Error marked as resolved"),z(),L()}catch(e){m.error("Failed to resolve error")}})(e.id),className:"flex items-center gap-1",children:[s.jsx(x,{className:"h-4 w-4"}),"Resolve"]}),s.jsxs(l,{size:"sm",variant:"outline",onClick:()=>(async s=>{if(confirm("Are you sure you want to delete this error log?"))try{await o.deleteError(s),m.success("Error deleted successfully"),z(),L()}catch(e){m.error("Failed to delete error")}})(e.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700",children:[s.jsx(v,{className:"h-4 w-4"}),"Delete"]})]})]}),e.stack_trace&&s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 hover:text-gray-900",children:"View Stack Trace"}),s.jsx("pre",{className:"mt-2 p-3 bg-white rounded text-xs overflow-auto max-h-48 border",children:e.stack_trace})]})]},e.id);var r})}),b.pages>1&&s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Showing page ",b.page," of ",b.pages]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(l,{variant:"outline",size:"sm",onClick:()=>w({...b,page:b.page-1}),disabled:1===b.page,children:"Previous"}),s.jsx(l,{variant:"outline",size:"sm",onClick:()=>w({...b,page:b.page+1}),disabled:b.page>=b.pages,children:"Next"})]})]})]})]})]})};export{y as default};
